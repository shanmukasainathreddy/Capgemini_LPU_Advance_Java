package com.connectdatabase;

import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.sql.Statement;
import java.sql.Connection;
import java.util.Scanner;

public class EmployeeConnectionbysituation {

	public static void main(String[] args) {
		// TODO Auto-generated method stub
		String url = "jdbc:postgresql://localhost:5432/College";
		String un = "postgres";
		String pwd = "root";
		
		Scanner sc = new Scanner(System.in);
		
		try {
			Class.forName("org.postgresql.Driver");
			
			
			Connection connect = DriverManager.getConnection(url,un,pwd);
			
			
//			Statement stmt = connect.createStatement();
//			String sql2 = "alter table employee add salary int";
//			
//			stmt.execute(sql2);
			
			String sql = "insert into employee values(?,?,?,?)";
			
			PreparedStatement pstm = connect.prepareStatement(sql);
			
			System.out.println("Enter ID: ");
			int id = sc.nextInt();
			pstm.setInt(1, id);
			
			System.out.println("Enter Name: ");
			String name = sc.next();
			pstm.setString(2, name);
			
			System.out.println("Enter eCompany: ");
			String eCompany = sc.next();
			pstm.setString(3, eCompany);

			System.out.println("Enter Salary: ");
			int salary = sc.nextInt();
			pstm.setInt(4, salary);
			
			pstm.execute();
			
			connect.close();
			
			
			} catch (SQLException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
		} catch (ClassNotFoundException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}	


public static void AddEmployee() {
	String url = "jdbc:postgresql://localhost:5432/College";
	String un = "postgres";
	String pwd = "root";
	
	try {
		Class.forName("org.postgresql.Driver");
		
		
		Connection connect = DriverManager.getConnection(url,un,pwd);
		
		catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		
	catch (ClassNotFoundException e) {
		// TODO Auto-generated catch block
		e.printStackTrace();
	}
}
public  static void DeleteEmpById() {
	String url = "jdbc:postgresql://localhost:5432/College";
	String un = "postgres";
	String pwd = "root";
	
	Scanner sc = new Scanner(System.in);
	try {
        Class.forName("org.postgresql.Driver");
        Connection con = DriverManager.getConnection(url, un, pwd);

        String sql = "delete from employee where id = ?";
        PreparedStatement ps = con.prepareStatement(sql);

        System.out.println("Enter Employee ID to Delete: ");
        int id = sc.nextInt();
        ps.setInt(1, id);

        int rows = ps.executeUpdate();

        if (rows > 0) {
            System.out.println("Employee Deleted ✅");
        } else {
            System.out.println("Employee Not Found ❌");
        }

        con.close();
    } catch (Exception e) {
        e.printStackTrace();
    }
}
public  static void  UpdateEmpById() {
	String url = "jdbc:postgresql://localhost:5432/College";
    String un = "postgres";
    String pwd = "root";

    Scanner sc = new Scanner(System.in);

    try {
        Class.forName("org.postgresql.Driver");
        Connection con = DriverManager.getConnection(url, un, pwd);

        String sql = "update employee set salary = ? where id = ?";
        PreparedStatement ps = con.prepareStatement(sql);

        System.out.println("Enter New Salary: ");
        int salary = sc.nextInt();

        System.out.println("Enter Employee ID: ");
        int id = sc.nextInt();

        ps.setInt(1, salary);
        ps.setInt(2, id);

        int rows = ps.executeUpdate();

        if (rows > 0) {
            System.out.println("Employee Updated ✅");
        } else {
            System.out.println("Employee Not Found ❌");
        }

        con.close();
    } catch (Exception e) {
        e.printStackTrace();
    }
	
}
public static void FindEmployeeById() {
	String url = "jdbc:postgresql://localhost:5432/College";
    String un = "postgres";
    String pwd = "root";

    Scanner sc = new Scanner(System.in);

    try {
        Class.forName("org.postgresql.Driver");
        Connection con = DriverManager.getConnection(url, un, pwd);

        String sql = "select * from employee where id = ?";
        PreparedStatement ps = con.prepareStatement(sql);

        System.out.println("Enter Employee ID: ");
        int id = sc.nextInt();
        ps.setInt(1, id);

        ResultSet rs = ps.executeQuery();

        if (rs.next()) {
            System.out.println("ID: " + rs.getInt(1));
            System.out.println("Name: " + rs.getString(2));
            System.out.println("Company: " + rs.getString(3));
            System.out.println("Salary: " + rs.getInt(4));
        } else {
            System.out.println("Employee Not Found ❌");
        }

        con.close();
    } catch (Exception e) {
        e.printStackTrace();
    }
}
}
